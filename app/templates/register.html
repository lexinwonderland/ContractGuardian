<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Register</title>
	<link rel="stylesheet" href="/static/style.css" />
</head>
<body>
	<header>
		<h1>Register</h1>
		<nav>
			<a href="/">Home</a>
			{% if user %}
				<a href="#" onclick="logout()">Logout</a>
			{% else %}
				<a href="/login">Login</a>
			{% endif %}
		</nav>
	</header>
	<main>
		<form id="registerForm">
			<label>Email
				<input name="email" type="email" required />
			</label>
			<label>Password
				<input name="password" type="password" required />
			</label>
			<button type="submit">Create Account</button>
		</form>
		<div id="msg"></div>
	</main>
	<script>
	const form = document.getElementById('registerForm');
	const msg = document.getElementById('msg');
	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		const fd = new FormData(form);
		const res = await fetch('/auth/register', { method: 'POST', body: fd });
		if (res.ok) {
			location.href = '/login';
		} else {
			const err = await res.json().catch(()=>({detail:'Registration failed'}));
			msg.textContent = err.detail || 'Registration failed';
		}
	});
	async function logout() {
		const res = await fetch('/auth/logout', { method: 'POST', credentials: 'include' });
		if (res.ok) {
			location.href = '/';
		}
	}
	</script>
</body>
</html> 